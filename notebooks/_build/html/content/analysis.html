
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preprocessing FEX data &#8212; Py-Feat</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-113777015-5"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-113777015-5');
    </script>    
        
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting examples" href="plotting.html" />
    <link rel="prev" title="Detecting FEX from images" href="detector.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/pyfeat_logo_small.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Py-Feat</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Py-Feat: Python Facial Expression Analysis Toolbox
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation example
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="detector.html">
   Detecting FEX from images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detector.html#detecting-fex-from-videos">
   Detecting FEX from videos
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Preprocessing FEX data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#analyzing-fex-data">
   Analyzing FEX data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting.html">
   Plotting examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loadingOtherFiles.html">
   Loading data from other detectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="train_hogs.html">
   Training HOG-based AU detectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="trainAUvisModel.html">
   Training AU visualization model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modelContribution.html">
   Contributing new detectors
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html">
   API Reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat.detector">
   feat.detector module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat.data">
   feat.data module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat.plotting">
   feat.plotting module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat.utils">
   feat.utils module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat.version">
   feat.version module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../api/index.html#module-feat">
   Module contents
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="contribute.html">
   Contribute
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/cosanlab/py-feat">
   GitHub Repository
   <i class="fas fa-external-link-alt">
   </i>
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cosanlab/py-feat"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cosanlab/py-feat/issues/new?title=Issue%20on%20page%20%2Fcontent/analysis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cosanlab/py-feat/master?urlpath=tree/notebooks/content/analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jhub.dartmouth.edu//hub/user-redirect/git-pull?repo=https://github.com/cosanlab/py-feat&urlpath=tree/py-feat/notebooks/content/analysis.ipynb&branch=master"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/cosanlab/py-feat/blob/master/notebooks/content/analysis.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Preprocessing FEX data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-preprocess-and-analyze-facial-expression-data-with-feat">
     How to preprocess and analyze facial expression data with Feat.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-features">
     Extract features
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyzing-fex-data">
   Analyzing FEX data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-t-test">
     Simple t-test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-sample-independent-t-test">
     Two sample independent t-test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prediction">
     Prediction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression">
     Regression
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intersubject-or-intervideo-correlations">
     Intersubject (or intervideo) correlations
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="preprocessing-fex-data">
<h1>Preprocessing FEX data<a class="headerlink" href="#preprocessing-fex-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-to-preprocess-and-analyze-facial-expression-data-with-feat">
<h2>How to preprocess and analyze facial expression data with Feat.<a class="headerlink" href="#how-to-preprocess-and-analyze-facial-expression-data-with-feat" title="Permalink to this headline">¶</a></h2>
<p><em>Written by Jin Hyun Cheong</em></p>
<p>Here we will be using a sample dataset by David Watson on <a class="reference external" href="https://journals.plos.org/ploscompbiol/article/peerReview?id=10.1371/journal.pcbi.1008335">“A Data-Driven Characterisation Of Natural Facial Expressions When Giving Good And Bad News”</a> by Watson &amp; Johnston 2020. The full dataset is available on <a class="reference external" href="https://osf.io/6tbwj/">OSF</a>.</p>
<p>Let’s start by installing Py-FEAT if you have not already done so or using this on Google Colab</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -q py-feat
</pre></div>
</div>
</div>
</div>
<p>First, we download the necessary files &amp; videos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="n">files_to_download</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;4c5mb&quot;</span><span class="p">,</span> <span class="s2">&quot;n6rt3&quot;</span><span class="p">,</span> <span class="s2">&quot;3gh8v&quot;</span><span class="p">,</span> <span class="s2">&quot;twqxs&quot;</span><span class="p">,</span> <span class="s2">&quot;nc7d9&quot;</span><span class="p">,</span> <span class="s2">&quot;nrwcm&quot;</span><span class="p">,</span> <span class="s2">&quot;2rk9c&quot;</span><span class="p">,</span> <span class="s2">&quot;mxkzq&quot;</span><span class="p">,</span> <span class="s2">&quot;c2na7&quot;</span><span class="p">,</span> <span class="s2">&quot;wj7zy&quot;</span><span class="p">,</span> <span class="s2">&quot;mxywn&quot;</span><span class="p">,</span> 
                     <span class="s2">&quot;6bn3g&quot;</span><span class="p">,</span> <span class="s2">&quot;jkwsp&quot;</span><span class="p">,</span> <span class="s2">&quot;54gtv&quot;</span><span class="p">,</span> <span class="s2">&quot;c3hpm&quot;</span><span class="p">,</span> <span class="s2">&quot;utdqj&quot;</span><span class="p">,</span> <span class="s2">&quot;hpw4a&quot;</span><span class="p">,</span> <span class="s2">&quot;94swe&quot;</span><span class="p">,</span> <span class="s2">&quot;qte5y&quot;</span><span class="p">,</span> <span class="s2">&quot;aykvu&quot;</span><span class="p">,</span> <span class="s2">&quot;3d5ry&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">fid</span> <span class="ow">in</span> <span class="n">files_to_download</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;wget --content-disposition https://osf.io/</span><span class="si">{</span><span class="n">fid</span><span class="si">}</span><span class="s2">/download&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Check that videos have been downloaded and the attributes file, `clip_attrs.csv) explaining</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>

<span class="n">clip_attrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;clip_attrs.csv&quot;</span><span class="p">)</span>
<span class="n">videos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.mp4&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">videos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;001.mp4&#39; &#39;002.mp4&#39; &#39;003.mp4&#39; &#39;004.mp4&#39; &#39;005.mp4&#39; &#39;006.mp4&#39; &#39;007.mp4&#39;
 &#39;008.mp4&#39; &#39;009.mp4&#39; &#39;010.mp4&#39; &#39;011.mp4&#39; &#39;012.mp4&#39; &#39;013.mp4&#39; &#39;014.mp4&#39;
 &#39;015.mp4&#39; &#39;016.mp4&#39; &#39;017.mp4&#39; &#39;018.mp4&#39; &#39;019.mp4&#39; &#39;020.mp4&#39;]
</pre></div>
</div>
</div>
</div>
<p>Process each video using our detector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">feat</span> <span class="kn">import</span> <span class="n">Detector</span>
<span class="n">detector</span> <span class="o">=</span> <span class="n">Detector</span><span class="p">(</span><span class="n">au_model</span> <span class="o">=</span> <span class="s2">&quot;rf&quot;</span><span class="p">,</span> <span class="n">emotion_model</span> <span class="o">=</span> <span class="s2">&quot;resmasknet&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">videos</span><span class="p">:</span> 
    <span class="n">detector</span><span class="o">.</span><span class="n">detect_video</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="n">outputFname</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">feat.utils</span> <span class="kn">import</span> <span class="n">read_feat</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">for</span> <span class="n">ix</span> <span class="p">,</span><span class="n">video</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">videos</span><span class="p">):</span>
    <span class="n">outputF</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="n">fex</span> <span class="o">=</span> <span class="n">read_feat</span><span class="p">(</span><span class="n">outputF</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fex</span><span class="p">,</span> <span class="n">read_feat</span><span class="p">(</span><span class="n">outputF</span><span class="p">)])</span>
<span class="n">fex</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in conditions</span>
<span class="n">clip_attrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;clip_attrs.csv&quot;</span><span class="p">)</span>
<span class="n">clip_attrs</span> <span class="o">=</span> <span class="n">clip_attrs</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="n">clip_attrs</span><span class="o">.</span><span class="n">clipN</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.mp4&quot;</span><span class="p">),</span>
                               <span class="n">condition</span> <span class="o">=</span> <span class="n">clip_attrs</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;gn&quot;</span><span class="p">:</span><span class="s2">&quot;goodNews&quot;</span><span class="p">,</span> <span class="s2">&quot;ists&quot;</span><span class="p">:</span><span class="s2">&quot;badNews&quot;</span><span class="p">}))</span>
<span class="n">input_class_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">clip_attrs</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">clip_attrs</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]))</span>
<span class="n">clip_attrs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>clipN</th>
      <th>class</th>
      <th>phraseN</th>
      <th>phrase_txt</th>
      <th>input</th>
      <th>condition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>gn</td>
      <td>1</td>
      <td>your loan has been approved</td>
      <td>001.mp4</td>
      <td>goodNews</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>gn</td>
      <td>2</td>
      <td>you've got the job</td>
      <td>002.mp4</td>
      <td>goodNews</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>gn</td>
      <td>3</td>
      <td>the vendor has accepted your offer</td>
      <td>003.mp4</td>
      <td>goodNews</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>gn</td>
      <td>4</td>
      <td>your tests have come back clear</td>
      <td>004.mp4</td>
      <td>goodNews</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>gn</td>
      <td>5</td>
      <td>your application has been accepted</td>
      <td>005.mp4</td>
      <td>goodNews</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="extract-features">
<h2>Extract features<a class="headerlink" href="#extract-features" title="Permalink to this headline">¶</a></h2>
<p>You can set the <code class="docutils literal notranslate"><span class="pre">sessions</span></code> attribute to provide a grouping of your experimental setup. This could be the name of each video if you want to extract features per video or it could be conditions to extract features per condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract conditions between the two condtiiosn (gn: good news, ists: bad news)</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">clip_attrs</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">clip_attrs</span><span class="p">[</span><span class="s1">&#39;condition&#39;</span><span class="p">]))</span>
<span class="n">fex</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">input</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span>
<span class="n">average_au_intensity_per_video</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">extract_mean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_AU01</th>
      <th>mean_AU02</th>
      <th>mean_AU04</th>
      <th>mean_AU05</th>
      <th>mean_AU06</th>
      <th>mean_AU07</th>
      <th>mean_AU09</th>
      <th>mean_AU10</th>
      <th>mean_AU11</th>
      <th>mean_AU12</th>
      <th>...</th>
      <th>mean_y_61</th>
      <th>mean_y_62</th>
      <th>mean_y_63</th>
      <th>mean_y_64</th>
      <th>mean_y_65</th>
      <th>mean_y_66</th>
      <th>mean_y_67</th>
      <th>mean_y_7</th>
      <th>mean_y_8</th>
      <th>mean_y_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>badNews</th>
      <td>0.370603</td>
      <td>0.347909</td>
      <td>0.274446</td>
      <td>0.470608</td>
      <td>0.144680</td>
      <td>0.350956</td>
      <td>0.057206</td>
      <td>0.367228</td>
      <td>0.414330</td>
      <td>0.245751</td>
      <td>...</td>
      <td>714.571030</td>
      <td>715.994335</td>
      <td>711.230906</td>
      <td>703.585629</td>
      <td>715.312303</td>
      <td>720.341735</td>
      <td>718.979703</td>
      <td>823.783636</td>
      <td>827.212203</td>
      <td>813.770216</td>
    </tr>
    <tr>
      <th>goodNews</th>
      <td>0.437070</td>
      <td>0.399585</td>
      <td>0.209061</td>
      <td>0.219561</td>
      <td>0.641241</td>
      <td>0.642395</td>
      <td>0.161864</td>
      <td>0.775689</td>
      <td>0.412116</td>
      <td>0.814605</td>
      <td>...</td>
      <td>684.355943</td>
      <td>686.797688</td>
      <td>683.110011</td>
      <td>676.147267</td>
      <td>693.425396</td>
      <td>697.551264</td>
      <td>695.402943</td>
      <td>810.933791</td>
      <td>817.027471</td>
      <td>806.257672</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 169 columns</p>
</div></div></div>
</div>
<p>Or simply extract features per video</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract features per video</span>
<span class="n">fex</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">input</span><span class="p">()</span>
<span class="n">average_au_intensity_per_video</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">extract_mean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_AU01</th>
      <th>mean_AU02</th>
      <th>mean_AU04</th>
      <th>mean_AU05</th>
      <th>mean_AU06</th>
      <th>mean_AU07</th>
      <th>mean_AU09</th>
      <th>mean_AU10</th>
      <th>mean_AU11</th>
      <th>mean_AU12</th>
      <th>...</th>
      <th>mean_y_61</th>
      <th>mean_y_62</th>
      <th>mean_y_63</th>
      <th>mean_y_64</th>
      <th>mean_y_65</th>
      <th>mean_y_66</th>
      <th>mean_y_67</th>
      <th>mean_y_7</th>
      <th>mean_y_8</th>
      <th>mean_y_9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>001.mp4</th>
      <td>0.367902</td>
      <td>0.304953</td>
      <td>0.217278</td>
      <td>0.247205</td>
      <td>0.529641</td>
      <td>0.546710</td>
      <td>0.127434</td>
      <td>0.689482</td>
      <td>0.405150</td>
      <td>0.757060</td>
      <td>...</td>
      <td>694.305659</td>
      <td>696.236139</td>
      <td>692.150659</td>
      <td>682.592831</td>
      <td>696.408174</td>
      <td>700.882806</td>
      <td>699.187324</td>
      <td>814.856982</td>
      <td>819.742603</td>
      <td>808.427911</td>
    </tr>
    <tr>
      <th>002.mp4</th>
      <td>0.384290</td>
      <td>0.372414</td>
      <td>0.218073</td>
      <td>0.238233</td>
      <td>0.466245</td>
      <td>0.568260</td>
      <td>0.139705</td>
      <td>0.645774</td>
      <td>0.406103</td>
      <td>0.665162</td>
      <td>...</td>
      <td>686.464658</td>
      <td>688.592334</td>
      <td>685.344299</td>
      <td>677.572549</td>
      <td>688.540245</td>
      <td>692.234408</td>
      <td>690.349490</td>
      <td>806.882534</td>
      <td>812.669819</td>
      <td>802.669351</td>
    </tr>
    <tr>
      <th>003.mp4</th>
      <td>0.475926</td>
      <td>0.435061</td>
      <td>0.193346</td>
      <td>0.235034</td>
      <td>0.628517</td>
      <td>0.614398</td>
      <td>0.130048</td>
      <td>0.758156</td>
      <td>0.406965</td>
      <td>0.822223</td>
      <td>...</td>
      <td>678.527397</td>
      <td>681.056783</td>
      <td>677.828855</td>
      <td>672.959971</td>
      <td>688.190226</td>
      <td>691.792301</td>
      <td>689.539840</td>
      <td>803.369594</td>
      <td>810.371285</td>
      <td>800.508759</td>
    </tr>
    <tr>
      <th>004.mp4</th>
      <td>0.465396</td>
      <td>0.431265</td>
      <td>0.215378</td>
      <td>0.136780</td>
      <td>0.719656</td>
      <td>0.712953</td>
      <td>0.195271</td>
      <td>0.852897</td>
      <td>0.413281</td>
      <td>0.888342</td>
      <td>...</td>
      <td>682.179613</td>
      <td>684.565805</td>
      <td>680.513723</td>
      <td>674.068777</td>
      <td>694.367983</td>
      <td>698.833575</td>
      <td>696.740101</td>
      <td>811.564575</td>
      <td>817.511093</td>
      <td>806.248735</td>
    </tr>
    <tr>
      <th>005.mp4</th>
      <td>0.358873</td>
      <td>0.346983</td>
      <td>0.196898</td>
      <td>0.132950</td>
      <td>0.729992</td>
      <td>0.724506</td>
      <td>0.230352</td>
      <td>0.844839</td>
      <td>0.421897</td>
      <td>0.883427</td>
      <td>...</td>
      <td>701.603967</td>
      <td>703.849507</td>
      <td>699.122215</td>
      <td>687.917109</td>
      <td>711.293560</td>
      <td>716.390717</td>
      <td>714.357210</td>
      <td>827.466633</td>
      <td>833.453529</td>
      <td>821.740933</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 169 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="analyzing-fex-data">
<h1>Analyzing FEX data<a class="headerlink" href="#analyzing-fex-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="simple-t-test">
<h2>Simple t-test<a class="headerlink" href="#simple-t-test" title="Permalink to this headline">¶</a></h2>
<p>You can use a simple t-test to test if the average activation of a certain AU is significantly higher than .5 (chance). The results suggests that AU10 (upper lip raiser), 12 (lip corner puller), and 14 (dimpler) is significantly activitated when providing good news.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_class_map</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="p">[</span><span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">sessions</span><span class="o">==</span><span class="s2">&quot;goodNews&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">aus</span><span class="p">()</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">au_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t</th>
      <th>p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean_AU01</th>
      <td>-2.927201</td>
      <td>1.683346e-02</td>
    </tr>
    <tr>
      <th>mean_AU02</th>
      <td>-5.838201</td>
      <td>2.473720e-04</td>
    </tr>
    <tr>
      <th>mean_AU04</th>
      <td>-49.805912</td>
      <td>2.660164e-12</td>
    </tr>
    <tr>
      <th>mean_AU05</th>
      <td>-11.942339</td>
      <td>8.022300e-07</td>
    </tr>
    <tr>
      <th>mean_AU06</th>
      <td>3.905366</td>
      <td>3.589972e-03</td>
    </tr>
    <tr>
      <th>mean_AU07</th>
      <td>5.487334</td>
      <td>3.864728e-04</td>
    </tr>
    <tr>
      <th>mean_AU09</th>
      <td>-22.647961</td>
      <td>3.024835e-09</td>
    </tr>
    <tr>
      <th>mean_AU10</th>
      <td>10.361594</td>
      <td>2.660301e-06</td>
    </tr>
    <tr>
      <th>mean_AU11</th>
      <td>-42.691265</td>
      <td>1.059418e-11</td>
    </tr>
    <tr>
      <th>mean_AU12</th>
      <td>11.949046</td>
      <td>7.984040e-07</td>
    </tr>
    <tr>
      <th>mean_AU14</th>
      <td>23.155621</td>
      <td>2.485336e-09</td>
    </tr>
    <tr>
      <th>mean_AU15</th>
      <td>-12.587565</td>
      <td>5.119202e-07</td>
    </tr>
    <tr>
      <th>mean_AU17</th>
      <td>-0.460219</td>
      <td>6.562759e-01</td>
    </tr>
    <tr>
      <th>mean_AU20</th>
      <td>-45.470892</td>
      <td>6.019391e-12</td>
    </tr>
    <tr>
      <th>mean_AU23</th>
      <td>-0.300423</td>
      <td>7.706780e-01</td>
    </tr>
    <tr>
      <th>mean_AU24</th>
      <td>-4.533345</td>
      <td>1.419377e-03</td>
    </tr>
    <tr>
      <th>mean_AU25</th>
      <td>3.119502</td>
      <td>1.232852e-02</td>
    </tr>
    <tr>
      <th>mean_AU26</th>
      <td>-5.015769</td>
      <td>7.232461e-04</td>
    </tr>
    <tr>
      <th>mean_AU28</th>
      <td>-7.169935</td>
      <td>5.251451e-05</td>
    </tr>
    <tr>
      <th>mean_AU43</th>
      <td>-78.139016</td>
      <td>4.660607e-14</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="two-sample-independent-t-test">
<h2>Two sample independent t-test<a class="headerlink" href="#two-sample-independent-t-test" title="Permalink to this headline">¶</a></h2>
<p>You can also perform an independent two sample ttest between two sessions which in this case is goodNews vs badNews.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns2compare</span> <span class="o">=</span> <span class="s2">&quot;mean_AU12&quot;</span>
<span class="n">sessions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;goodNews&quot;</span><span class="p">,</span> <span class="s2">&quot;badNews&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="n">columns2compare</span><span class="p">,</span> <span class="n">sessions</span><span class="o">=</span><span class="n">sessions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T-test between </span><span class="si">{</span><span class="n">sessions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">sessions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">: t=</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">.2g</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="o">.</span><span class="n">sessions</span><span class="p">,</span> 
            <span class="n">y</span> <span class="o">=</span> <span class="n">columns2compare</span><span class="p">,</span> 
            <span class="n">data</span> <span class="o">=</span> <span class="n">average_au_intensity_per_video</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-test between goodNews vs badNews: t=17, p=2.32e-12
</pre></div>
</div>
<img alt="../_images/analysis_17_1.png" src="../_images/analysis_17_1.png" />
</div>
</div>
</div>
<div class="section" id="prediction">
<h2>Prediction<a class="headerlink" href="#prediction" title="Permalink to this headline">¶</a></h2>
<p>If you want to know what combination of features predic the good news or bad news conditions. To investigate this problem, we can train a Logistc Regression model using emotion labels to predict the conditions. Results suggest that detections of happy expressions predict the delivery of good news.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fex</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">input</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_class_map</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">fex</span><span class="o">.</span><span class="n">emotions</span><span class="p">(),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">sessions</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;liblinear&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;score: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">fex</span><span class="o">.</span><span class="n">emotions</span><span class="p">(),</span> <span class="n">fex</span><span class="o">.</span><span class="n">sessions</span><span class="p">)</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;coefficients for predicting class: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">classes_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">emotions</span><span class="p">()</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>score: 0.933
coefficients for predicting class: goodNews
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>anger</th>
      <th>disgust</th>
      <th>fear</th>
      <th>happiness</th>
      <th>sadness</th>
      <th>surprise</th>
      <th>neutral</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.722285</td>
      <td>-0.566583</td>
      <td>-2.868222</td>
      <td>8.24894</td>
      <td>-2.434085</td>
      <td>-0.096825</td>
      <td>-3.030539</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h2>
<p>We can also run an fMRI style regression to predict the Action Unit activities from a contrast of conditions. This analysis can be conducted through the <code class="docutils literal notranslate"><span class="pre">regress</span></code> method. In this example, we identify the action units that are significantly more active in the good news versus the bad news conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fex</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">input</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_class_map</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;goodNews&quot;</span><span class="p">:</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;badNews&quot;</span><span class="p">:</span><span class="o">-.</span><span class="mi">5</span><span class="p">})</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fex</span><span class="o">.</span><span class="n">sessions</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">residuals</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">aus</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Betas predicting good news estimated for each emotion.&quot;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">b</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;betas&quot;</span><span class="p">}),</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;t-stats&quot;</span><span class="p">}),</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;p-values&quot;</span><span class="p">})])</span>
<span class="n">display</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Betas predicting good news estimated for each emotion.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jcheong/anaconda3/lib/python3.8/site-packages/nltools/stats.py:970: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  stderr = np.sqrt(np.diag(np.linalg.pinv(np.dot(X.T, X))))[:, np.newaxis] * sigma[np.newaxis, :]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AU01</th>
      <th>AU02</th>
      <th>AU04</th>
      <th>AU05</th>
      <th>AU06</th>
      <th>AU07</th>
      <th>AU09</th>
      <th>AU10</th>
      <th>AU11</th>
      <th>AU12</th>
      <th>AU14</th>
      <th>AU15</th>
      <th>AU17</th>
      <th>AU20</th>
      <th>AU23</th>
      <th>AU24</th>
      <th>AU25</th>
      <th>AU26</th>
      <th>AU28</th>
      <th>AU43</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>betas</th>
      <td>0.066</td>
      <td>0.052</td>
      <td>-0.065</td>
      <td>-0.251</td>
      <td>0.497</td>
      <td>0.291</td>
      <td>0.105</td>
      <td>0.408</td>
      <td>-0.002</td>
      <td>0.569</td>
      <td>0.022</td>
      <td>0.111</td>
      <td>0.101</td>
      <td>0.038</td>
      <td>-0.029</td>
      <td>-0.284</td>
      <td>0.305</td>
      <td>0.140</td>
      <td>-0.016</td>
      <td>0.013</td>
    </tr>
    <tr>
      <th>t-stats</th>
      <td>8.221</td>
      <td>8.219</td>
      <td>-17.153</td>
      <td>-31.413</td>
      <td>43.783</td>
      <td>33.364</td>
      <td>21.079</td>
      <td>35.625</td>
      <td>-2.671</td>
      <td>46.713</td>
      <td>4.088</td>
      <td>17.515</td>
      <td>15.673</td>
      <td>7.927</td>
      <td>-5.063</td>
      <td>-22.483</td>
      <td>19.415</td>
      <td>16.822</td>
      <td>-2.293</td>
      <td>2.422</td>
    </tr>
    <tr>
      <th>p-values</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.008</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.022</td>
      <td>0.016</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="intersubject-or-intervideo-correlations">
<h2>Intersubject (or intervideo) correlations<a class="headerlink" href="#intersubject-or-intervideo-correlations" title="Permalink to this headline">¶</a></h2>
<p>To compare the similarity of signals over time between subjects or videos, you can use the <code class="docutils literal notranslate"><span class="pre">isc</span></code> method. You can get a sense of how much two signals, such as a certain action unit activity, correlates over time.</p>
<p>In this example, we are calculating the ISC over videos. We want to check how similar AU01 activations are across videos so our session is set to the <code class="docutils literal notranslate"><span class="pre">input</span></code> which is the video name. Executing the <code class="docutils literal notranslate"><span class="pre">isc</span></code> method shows that the temporal profile of AU01 activations form two clusters between the goodNews and the badNews conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fex</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">input</span><span class="p">()</span>
<span class="n">isc</span> <span class="o">=</span> <span class="n">fex</span><span class="o">.</span><span class="n">isc</span><span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="s2">&quot;AU01&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">isc</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/analysis_23_0.png" src="../_images/analysis_23_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="detector.html" title="previous page">Detecting FEX from images</a>
    <a class='right-next' id="next-link" href="plotting.html" title="next page">Plotting examples</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jin Hyun Cheong<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>